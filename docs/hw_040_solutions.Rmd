---
title: 'Домашнее задание 4.'
date: 'June 7, 2018'
output:
  html_document:
    keep_md: no
    number_sections: yes
    toc: yes
lang: ru-RU
editor_options:
  chunk_output_type: console
---

В четвёртой домашке будем искать главные компоненты в наборе данных об ирисах! 

* **Упражнение 0.**

Подключите пакеты `tidyverse`, `skimr`, `rio`, `factoextra`, `corrplot`. 
И постарайтесь вспомнить, для чего нужен каждый из них :)

```{r}
library(tidyverse) # обработка данных, графики...
library(skimr) # описательные статистики
library(rio) # импорт фантастического количества форматов данных
library(factoextra) # визуализации kmeans, pca
library(corrplot) # визуализация корреляций
```

Для упражнений мы будем использовать встроенный набор данных об ирисах.
Узнать подробности можно в справке командой `?iris`.

* **Упраженение 1.**

Сначала поймём, с чем мы будем иметь дело :)

- Посмотрите на описательные статистики набора данных `iris`.
    + Сколько в них наблюдений? Сколько переменных?
    + Есть ли пропуски?
- Нарисуйте диаграмму рассеяния для длины лепестка `Petal.Length` и ширины лепестка `Petal.Width`. Раскрасьте точки и измените их форму в соответствии с видом ириса `Species`. Добавьте вертикальную линию на уровне средней длины лепестка и горизонтальную на уровне средней ширины лепестка. Не забудьте добавить название и подписи к осям!

```{r}
skim(iris)

ggplot(data = iris) + 
  geom_point(aes(x = Petal.Length, y = Petal.Width, col = Species, shape = Species)) + 
  geom_vline(aes(xintercept = mean(Petal.Length)), linetype = 'dashed') +
  geom_hline(aes(yintercept = mean(Petal.Width)), linetype = 'dashed') +
  labs(x = 'Длина лепестка', y = 'Ширина лепестка', title = 'Диаграмма рассеяния')
```

- Каковы средняя длина и ширина лепестка?

- За что отвечает аргумент `linetype`?

* **Упражнение 2.**

- Постройте гистограммы длины чашелистника для каждого вида ириса отдельно.

- А затем нарисуйте скрипичные графики для ширины чашелистника.

```{r}
ggplot(data = iris) + 
  geom_histogram(aes(x = Sepal.Length)) + 
  facet_grid(Species ~ .) +
  labs(x = 'Длина чашелистника', title = 'Гистограмма')

ggplot(data = iris) + 
  geom_violin(aes(x = Species, y = Sepal.Width, fill = Species)) + 
  labs(x = 'Вид ириса', y = 'Ширина чашелистника', title = 'Скрипичный график')
```

- Сильно ли отличается распределение длины чашелистников по видам?

- У какого вида ириса в среднем самая большая ширина чашелистника?

* **Упражнение 3.**

Примените метод главных компонент к набору данных об ирисах, а затем визуализируйте результат в осях первых двух главных компонент.
Помните, что эти данные не отмасштабированы, а значит, функции `prcomp()` нужно передать важный аргумент! 
Подсказка появляется при нажатии кнопки `tab` внутри скобок :)

```{r}
iris_pca <- prcomp(iris[-5], scale. = TRUE)
iris_pca
fviz_pca_ind(iris_pca, label = 'none', habillage = iris$Species)
```

- Какую долю разброса данных объясняют первые две главные компоненты?

- Что изменится, если в функции `fviz_pca_ind()` не указывать аргументы `label` и `habillage`?

* **Упражнение 4.**

Нарисуйте проекции исходных переменных в осях первых двух главных компонент. 
Функции `fviz_pca_biplot` передайте аргумент, который делает подписи аккуратными.

```{r}
fviz_pca_biplot(iris_pca, geom.ind = 'point', habillage = iris$Species, repel = TRUE)
```

- Какая исходная переменная входит во вторую главную компоненту с большим весом?

- За что отвечает аргумент `geom.ind = 'point'`? Какие ещё возможны опции?

* **Упражнение 5.**

Визуализируйте процент разброса, который объясняет каждая главная компонента и добавьте эти значения на график.

```{r}
fviz_eig(iris_pca, addlabels = TRUE)
```

- Достаточно ли взять первую главную компоненту, чтобы объяснить 70% разброса даныых?

* **Упражнение 6.**

Визуализируйте вклад каждой переменной во вторую главную компоненту.

```{r}
fviz_contrib(iris_pca, choice = 'var', axes = 2)
```

- Вклад каких переменных во вторую главную компоненту можно считать значительным? 

* **Упражнение 7. **

Домашка выполнена! 
Ура :) 
Теперь её можно показывать всем!
Загрузите файл с домашним заданием `hw_040.Rmd` в свой гитхаб-репозиторий.
